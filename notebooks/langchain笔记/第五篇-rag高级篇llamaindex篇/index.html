<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content='ç¬¬äº”ç¯‡ RAGé«˜çº§ç¯‡ (LlamaIndex)# ç›®æ ‡: åœ¨æŒæ¡ LlamaIndex åŸºç¡€ç»„ä»¶ï¼ˆIndex, Retriever, QueryEngineï¼‰çš„åŸºç¡€ä¸Šï¼Œæ·±å…¥å­¦ä¹ å…¶"æ€æ‰‹é”"çº§çš„é«˜çº§æ£€ç´¢ç­–ç•¥ä¸ Agent é›†æˆèƒ½åŠ›ã€‚æœ¬ç¯‡å°†å¸¦ä½ ä»"èƒ½ç”¨"è¿›åŒ–åˆ°"å¥½ç”¨"ã€‚
ğŸ“‹ å‰ç½®å‡†å¤‡# æœ¬ç¯‡åŸºäº LlamaIndex v0.10+ ç‰ˆæœ¬ï¼Œå»ºè®®å…ˆå®Œæˆç¬¬å››ç¯‡çš„ç¯å¢ƒé…ç½®ã€‚
# å®‰è£…é«˜çº§ç»„ä»¶ä¾èµ– pip install llama-index-retrievers-bm25 pip install llama-index-postprocessor-cohere-rerank pip install llama-index-graph-stores-neo4j pip install llama-parse ç¬¬1ç« ï¼šæ··åˆæ£€ç´¢ (Hybrid Retrieval)# å•ä¸€çš„å‘é‡æ£€ç´¢ï¼ˆSemantic Searchï¼‰åœ¨å¤„ç†ç²¾ç¡®å…³é”®è¯åŒ¹é…ï¼ˆå¦‚äº§å“å‹å·ã€ä¸“æœ‰åè¯ï¼‰æ—¶å¾€å¾€è¡¨ç°ä¸ä½³ã€‚æ··åˆæ£€ç´¢é€šè¿‡ç»“åˆ BM25ï¼ˆå…³é”®è¯ï¼‰ å’Œ Vectorï¼ˆè¯­ä¹‰ï¼‰ï¼Œäº’è¡¥é•¿çŸ­ã€‚
1.1 ä¸ºä»€ä¹ˆéœ€è¦æ··åˆæ£€ç´¢ï¼Ÿ# å‘é‡æ£€ç´¢ï¼šæ“…é•¿ç†è§£"æ„å›¾"å’Œ"æ¦‚å¿µ"ã€‚ä¾‹å¦‚æœ"è‹¹æœæ‰‹æœº"ï¼Œèƒ½åŒ¹é…åˆ°"iPhone"ã€‚ å…³é”®è¯æ£€ç´¢ï¼šæ“…é•¿ç²¾ç¡®åŒ¹é…ã€‚ä¾‹å¦‚æœ"é”™è¯¯ç  502"ï¼Œå‘é‡å¯èƒ½ä¼šåŒ¹é…åˆ°"ç½‘ç»œé”™è¯¯"ï¼Œä½† BM25 èƒ½ç²¾ç¡®å‘½ä¸­åŒ…å«"502"çš„æ–‡æ¡£ã€‚ 1.2 å®æˆ˜ï¼šæ„å»ºæ··åˆæ£€ç´¢å™¨# LlamaIndex æä¾›äº† QueryFusionRetriever æ¥ä¼˜é›…åœ°èåˆå¤šç§æ£€ç´¢ç»“æœã€‚
from llama_index.core import VectorStoreIndex, SimpleDirectoryReader, StorageContext from llama_index.retrievers.bm25 import BM25Retriever from llama_index.core.retrievers import QueryFusionRetriever from llama_index.core import Settings # 1. å‡†å¤‡æ•°æ®ä¸å‘é‡ç´¢å¼• documents = SimpleDirectoryReader("./data").load_data() vector_index = VectorStoreIndex.from_documents(documents) # 2. åˆ›å»º BM25 æ£€ç´¢å™¨ (åŸºäºå…³é”®è¯) # æ³¨æ„ï¼šBM25 éœ€è¦ docstore æ¥æ„å»ºå€’æ’ç´¢å¼• bm25_retriever = BM25Retriever.from_defaults( docstore=vector_index.docstore, similarity_top_k=5 ) # 3. åˆ›å»º Vector æ£€ç´¢å™¨ (åŸºäºè¯­ä¹‰) vector_retriever = vector_index.as_retriever(similarity_top_k=5) # 4. åˆ›å»ºèåˆæ£€ç´¢å™¨ (Hybrid) hybrid_retriever = QueryFusionRetriever( retrievers=[vector_retriever, bm25_retriever], num_queries=1, # ä¸ç”Ÿæˆæ‰©å±•æŸ¥è¯¢ï¼Œä»…èåˆå½“å‰ç»“æœ mode="reciprocal_rerank", # ä½¿ç”¨ RRF (å€’æ•°æ’åèåˆ) ç®—æ³• similarity_top_k=5, use_async=True ) # 5. æµ‹è¯•æ£€ç´¢ nodes = hybrid_retriever.retrieve("LlamaIndex çš„è‡ªåŠ¨åˆå¹¶æ£€ç´¢åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ") for node in nodes: print(f"å¾—åˆ†: {node.score:.4f} | å†…å®¹: {node.text[:50]}...") ç¬¬2ç« ï¼šæŸ¥è¯¢ä¼˜åŒ–ä¸è·¯ç”± (Routing & Transformation)# ç”¨æˆ·çš„ Query å¾€å¾€æ˜¯ä¸å®Œç¾çš„ï¼ˆæ¨¡ç³Šã€å¤æ‚ã€ç¼ºå¤±ä¸Šä¸‹æ–‡ï¼‰ã€‚LlamaIndex æä¾›äº†ä¸€ç³»åˆ—å·¥å…·æ¥"ä¿®å¤"æˆ–"åˆ†å‘"ç”¨æˆ·çš„æŸ¥è¯¢ã€‚
'><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://LordFoxFairy.github.io/notebooks/langchain%E7%AC%94%E8%AE%B0/%E7%AC%AC%E4%BA%94%E7%AF%87-rag%E9%AB%98%E7%BA%A7%E7%AF%87llamaindex%E7%AF%87/"><meta property="og:site_name" content="LordFoxFairyçš„ç¬”è®°æœ¬"><meta property="og:title" content="ç¬¬äº”ç¯‡ RAGé«˜çº§ç¯‡(LlamaIndexç¯‡)"><meta property="og:description" content='ç¬¬äº”ç¯‡ RAGé«˜çº§ç¯‡ (LlamaIndex)# ç›®æ ‡: åœ¨æŒæ¡ LlamaIndex åŸºç¡€ç»„ä»¶ï¼ˆIndex, Retriever, QueryEngineï¼‰çš„åŸºç¡€ä¸Šï¼Œæ·±å…¥å­¦ä¹ å…¶"æ€æ‰‹é”"çº§çš„é«˜çº§æ£€ç´¢ç­–ç•¥ä¸ Agent é›†æˆèƒ½åŠ›ã€‚æœ¬ç¯‡å°†å¸¦ä½ ä»"èƒ½ç”¨"è¿›åŒ–åˆ°"å¥½ç”¨"ã€‚
ğŸ“‹ å‰ç½®å‡†å¤‡# æœ¬ç¯‡åŸºäº LlamaIndex v0.10+ ç‰ˆæœ¬ï¼Œå»ºè®®å…ˆå®Œæˆç¬¬å››ç¯‡çš„ç¯å¢ƒé…ç½®ã€‚
# å®‰è£…é«˜çº§ç»„ä»¶ä¾èµ– pip install llama-index-retrievers-bm25 pip install llama-index-postprocessor-cohere-rerank pip install llama-index-graph-stores-neo4j pip install llama-parse ç¬¬1ç« ï¼šæ··åˆæ£€ç´¢ (Hybrid Retrieval)# å•ä¸€çš„å‘é‡æ£€ç´¢ï¼ˆSemantic Searchï¼‰åœ¨å¤„ç†ç²¾ç¡®å…³é”®è¯åŒ¹é…ï¼ˆå¦‚äº§å“å‹å·ã€ä¸“æœ‰åè¯ï¼‰æ—¶å¾€å¾€è¡¨ç°ä¸ä½³ã€‚æ··åˆæ£€ç´¢é€šè¿‡ç»“åˆ BM25ï¼ˆå…³é”®è¯ï¼‰ å’Œ Vectorï¼ˆè¯­ä¹‰ï¼‰ï¼Œäº’è¡¥é•¿çŸ­ã€‚
1.1 ä¸ºä»€ä¹ˆéœ€è¦æ··åˆæ£€ç´¢ï¼Ÿ# å‘é‡æ£€ç´¢ï¼šæ“…é•¿ç†è§£"æ„å›¾"å’Œ"æ¦‚å¿µ"ã€‚ä¾‹å¦‚æœ"è‹¹æœæ‰‹æœº"ï¼Œèƒ½åŒ¹é…åˆ°"iPhone"ã€‚ å…³é”®è¯æ£€ç´¢ï¼šæ“…é•¿ç²¾ç¡®åŒ¹é…ã€‚ä¾‹å¦‚æœ"é”™è¯¯ç  502"ï¼Œå‘é‡å¯èƒ½ä¼šåŒ¹é…åˆ°"ç½‘ç»œé”™è¯¯"ï¼Œä½† BM25 èƒ½ç²¾ç¡®å‘½ä¸­åŒ…å«"502"çš„æ–‡æ¡£ã€‚ 1.2 å®æˆ˜ï¼šæ„å»ºæ··åˆæ£€ç´¢å™¨# LlamaIndex æä¾›äº† QueryFusionRetriever æ¥ä¼˜é›…åœ°èåˆå¤šç§æ£€ç´¢ç»“æœã€‚
from llama_index.core import VectorStoreIndex, SimpleDirectoryReader, StorageContext from llama_index.retrievers.bm25 import BM25Retriever from llama_index.core.retrievers import QueryFusionRetriever from llama_index.core import Settings # 1. å‡†å¤‡æ•°æ®ä¸å‘é‡ç´¢å¼• documents = SimpleDirectoryReader("./data").load_data() vector_index = VectorStoreIndex.from_documents(documents) # 2. åˆ›å»º BM25 æ£€ç´¢å™¨ (åŸºäºå…³é”®è¯) # æ³¨æ„ï¼šBM25 éœ€è¦ docstore æ¥æ„å»ºå€’æ’ç´¢å¼• bm25_retriever = BM25Retriever.from_defaults( docstore=vector_index.docstore, similarity_top_k=5 ) # 3. åˆ›å»º Vector æ£€ç´¢å™¨ (åŸºäºè¯­ä¹‰) vector_retriever = vector_index.as_retriever(similarity_top_k=5) # 4. åˆ›å»ºèåˆæ£€ç´¢å™¨ (Hybrid) hybrid_retriever = QueryFusionRetriever( retrievers=[vector_retriever, bm25_retriever], num_queries=1, # ä¸ç”Ÿæˆæ‰©å±•æŸ¥è¯¢ï¼Œä»…èåˆå½“å‰ç»“æœ mode="reciprocal_rerank", # ä½¿ç”¨ RRF (å€’æ•°æ’åèåˆ) ç®—æ³• similarity_top_k=5, use_async=True ) # 5. æµ‹è¯•æ£€ç´¢ nodes = hybrid_retriever.retrieve("LlamaIndex çš„è‡ªåŠ¨åˆå¹¶æ£€ç´¢åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ") for node in nodes: print(f"å¾—åˆ†: {node.score:.4f} | å†…å®¹: {node.text[:50]}...") ç¬¬2ç« ï¼šæŸ¥è¯¢ä¼˜åŒ–ä¸è·¯ç”± (Routing & Transformation)# ç”¨æˆ·çš„ Query å¾€å¾€æ˜¯ä¸å®Œç¾çš„ï¼ˆæ¨¡ç³Šã€å¤æ‚ã€ç¼ºå¤±ä¸Šä¸‹æ–‡ï¼‰ã€‚LlamaIndex æä¾›äº†ä¸€ç³»åˆ—å·¥å…·æ¥"ä¿®å¤"æˆ–"åˆ†å‘"ç”¨æˆ·çš„æŸ¥è¯¢ã€‚'><meta property="og:locale" content="zh_cn"><meta property="og:type" content="article"><meta property="article:section" content="notebooks"><meta itemprop=name content="ç¬¬äº”ç¯‡ RAGé«˜çº§ç¯‡(LlamaIndexç¯‡)"><meta itemprop=description content='ç¬¬äº”ç¯‡ RAGé«˜çº§ç¯‡ (LlamaIndex)# ç›®æ ‡: åœ¨æŒæ¡ LlamaIndex åŸºç¡€ç»„ä»¶ï¼ˆIndex, Retriever, QueryEngineï¼‰çš„åŸºç¡€ä¸Šï¼Œæ·±å…¥å­¦ä¹ å…¶"æ€æ‰‹é”"çº§çš„é«˜çº§æ£€ç´¢ç­–ç•¥ä¸ Agent é›†æˆèƒ½åŠ›ã€‚æœ¬ç¯‡å°†å¸¦ä½ ä»"èƒ½ç”¨"è¿›åŒ–åˆ°"å¥½ç”¨"ã€‚
ğŸ“‹ å‰ç½®å‡†å¤‡# æœ¬ç¯‡åŸºäº LlamaIndex v0.10+ ç‰ˆæœ¬ï¼Œå»ºè®®å…ˆå®Œæˆç¬¬å››ç¯‡çš„ç¯å¢ƒé…ç½®ã€‚
# å®‰è£…é«˜çº§ç»„ä»¶ä¾èµ– pip install llama-index-retrievers-bm25 pip install llama-index-postprocessor-cohere-rerank pip install llama-index-graph-stores-neo4j pip install llama-parse ç¬¬1ç« ï¼šæ··åˆæ£€ç´¢ (Hybrid Retrieval)# å•ä¸€çš„å‘é‡æ£€ç´¢ï¼ˆSemantic Searchï¼‰åœ¨å¤„ç†ç²¾ç¡®å…³é”®è¯åŒ¹é…ï¼ˆå¦‚äº§å“å‹å·ã€ä¸“æœ‰åè¯ï¼‰æ—¶å¾€å¾€è¡¨ç°ä¸ä½³ã€‚æ··åˆæ£€ç´¢é€šè¿‡ç»“åˆ BM25ï¼ˆå…³é”®è¯ï¼‰ å’Œ Vectorï¼ˆè¯­ä¹‰ï¼‰ï¼Œäº’è¡¥é•¿çŸ­ã€‚
1.1 ä¸ºä»€ä¹ˆéœ€è¦æ··åˆæ£€ç´¢ï¼Ÿ# å‘é‡æ£€ç´¢ï¼šæ“…é•¿ç†è§£"æ„å›¾"å’Œ"æ¦‚å¿µ"ã€‚ä¾‹å¦‚æœ"è‹¹æœæ‰‹æœº"ï¼Œèƒ½åŒ¹é…åˆ°"iPhone"ã€‚ å…³é”®è¯æ£€ç´¢ï¼šæ“…é•¿ç²¾ç¡®åŒ¹é…ã€‚ä¾‹å¦‚æœ"é”™è¯¯ç  502"ï¼Œå‘é‡å¯èƒ½ä¼šåŒ¹é…åˆ°"ç½‘ç»œé”™è¯¯"ï¼Œä½† BM25 èƒ½ç²¾ç¡®å‘½ä¸­åŒ…å«"502"çš„æ–‡æ¡£ã€‚ 1.2 å®æˆ˜ï¼šæ„å»ºæ··åˆæ£€ç´¢å™¨# LlamaIndex æä¾›äº† QueryFusionRetriever æ¥ä¼˜é›…åœ°èåˆå¤šç§æ£€ç´¢ç»“æœã€‚
from llama_index.core import VectorStoreIndex, SimpleDirectoryReader, StorageContext from llama_index.retrievers.bm25 import BM25Retriever from llama_index.core.retrievers import QueryFusionRetriever from llama_index.core import Settings # 1. å‡†å¤‡æ•°æ®ä¸å‘é‡ç´¢å¼• documents = SimpleDirectoryReader("./data").load_data() vector_index = VectorStoreIndex.from_documents(documents) # 2. åˆ›å»º BM25 æ£€ç´¢å™¨ (åŸºäºå…³é”®è¯) # æ³¨æ„ï¼šBM25 éœ€è¦ docstore æ¥æ„å»ºå€’æ’ç´¢å¼• bm25_retriever = BM25Retriever.from_defaults( docstore=vector_index.docstore, similarity_top_k=5 ) # 3. åˆ›å»º Vector æ£€ç´¢å™¨ (åŸºäºè¯­ä¹‰) vector_retriever = vector_index.as_retriever(similarity_top_k=5) # 4. åˆ›å»ºèåˆæ£€ç´¢å™¨ (Hybrid) hybrid_retriever = QueryFusionRetriever( retrievers=[vector_retriever, bm25_retriever], num_queries=1, # ä¸ç”Ÿæˆæ‰©å±•æŸ¥è¯¢ï¼Œä»…èåˆå½“å‰ç»“æœ mode="reciprocal_rerank", # ä½¿ç”¨ RRF (å€’æ•°æ’åèåˆ) ç®—æ³• similarity_top_k=5, use_async=True ) # 5. æµ‹è¯•æ£€ç´¢ nodes = hybrid_retriever.retrieve("LlamaIndex çš„è‡ªåŠ¨åˆå¹¶æ£€ç´¢åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ") for node in nodes: print(f"å¾—åˆ†: {node.score:.4f} | å†…å®¹: {node.text[:50]}...") ç¬¬2ç« ï¼šæŸ¥è¯¢ä¼˜åŒ–ä¸è·¯ç”± (Routing & Transformation)# ç”¨æˆ·çš„ Query å¾€å¾€æ˜¯ä¸å®Œç¾çš„ï¼ˆæ¨¡ç³Šã€å¤æ‚ã€ç¼ºå¤±ä¸Šä¸‹æ–‡ï¼‰ã€‚LlamaIndex æä¾›äº†ä¸€ç³»åˆ—å·¥å…·æ¥"ä¿®å¤"æˆ–"åˆ†å‘"ç”¨æˆ·çš„æŸ¥è¯¢ã€‚'><meta itemprop=wordCount content="659"><title>ç¬¬äº”ç¯‡ RAGé«˜çº§ç¯‡(LlamaIndexç¯‡) | LordFoxFairyçš„ç¬”è®°æœ¬</title><link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://LordFoxFairy.github.io/notebooks/langchain%E7%AC%94%E8%AE%B0/%E7%AC%AC%E4%BA%94%E7%AF%87-rag%E9%AB%98%E7%BA%A7%E7%AF%87llamaindex%E7%AF%87/><link rel=stylesheet href=/book.min.6970156cec683193d93c9c4edaf0d56574e4361df2e0c1be4f697ae81c3ba55f.css integrity="sha256-aXAVbOxoMZPZPJxO2vDVZXTkNh3y4MG+T2l66Bw7pV8=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.a7a11a812549b6c20d4eeaf4a5a8317847527505f7a0ad3e6824fb320b3128a8.js integrity="sha256-p6EagSVJtsINTur0pagxeEdSdQX3oK0+aCT7MgsxKKg=" crossorigin=anonymous></script></head><body dir=ltr class="book-kind-page book-type-notebooks"><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>LordFoxFairyçš„ç¬”è®°æœ¬</span></a></h2><div class="book-search hidden"><input id=book-search-input type=text placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul><li><input type=checkbox id=section-8410cdd8ef137d6cb143c08e6db6ba10 class=toggle checked>
<label for=section-8410cdd8ef137d6cb143c08e6db6ba10 class=flex><a role=button>LangChainç¬”è®°</a>
<img src=/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/notebooks/langchain%E7%AC%94%E8%AE%B0/%E7%AC%AC%E4%B8%80%E7%AF%87-%E5%9F%BA%E7%A1%80%E8%AE%A4%E7%9F%A5/>ç¬¬ä¸€ç¯‡ åŸºç¡€è®¤çŸ¥</a></li><li><a href=/notebooks/langchain%E7%AC%94%E8%AE%B0/%E7%AC%AC%E4%BA%8C%E7%AF%87-%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B%E5%AE%9E%E6%88%98/>ç¬¬äºŒç¯‡ å¿«é€Ÿä¸Šæ‰‹å®æˆ˜</a></li><li><a href=/notebooks/langchain%E7%AC%94%E8%AE%B0/%E7%AC%AC%E4%B8%89%E7%AF%87-langgraph-%E6%B7%B1%E5%85%A5/>ç¬¬ä¸‰ç¯‡ LangGraph æ·±å…¥</a></li><li><a href=/notebooks/langchain%E7%AC%94%E8%AE%B0/%E7%AC%AC%E5%9B%9B%E7%AF%87-rag%E5%9F%BA%E7%A1%80%E7%AF%87langchain%E7%AF%87/>ç¬¬å››ç¯‡ RAGåŸºç¡€ç¯‡(LangChainç¯‡)</a></li><li><a href=/notebooks/langchain%E7%AC%94%E8%AE%B0/%E7%AC%AC%E5%9B%9B%E7%AF%87-rag%E5%9F%BA%E7%A1%80%E7%AF%87llamaindex%E7%AF%87/>ç¬¬å››ç¯‡ RAGåŸºç¡€ç¯‡(LlamaIndexç¯‡)</a></li><li><a href=/notebooks/langchain%E7%AC%94%E8%AE%B0/%E7%AC%AC%E4%BA%94%E7%AF%87-rag%E9%AB%98%E7%BA%A7%E7%AF%87langchain%E7%AF%87/>ç¬¬äº”ç¯‡ RAGé«˜çº§ç¯‡(LangChainç¯‡)</a></li><li><a href=/notebooks/langchain%E7%AC%94%E8%AE%B0/%E7%AC%AC%E4%BA%94%E7%AF%87-rag%E9%AB%98%E7%BA%A7%E7%AF%87llamaindex%E7%AF%87/ class=active>ç¬¬äº”ç¯‡ RAGé«˜çº§ç¯‡(LlamaIndexç¯‡)</a></li><li><a href=/notebooks/langchain%E7%AC%94%E8%AE%B0/%E7%AC%AC%E5%85%AD%E7%AF%87-%E6%96%87%E6%A1%A3%E5%A4%84%E7%90%86%E4%B8%8E%E6%95%B0%E6%8D%AE%E6%B8%85%E6%B4%97/>ç¬¬å…­ç¯‡ æ–‡æ¡£å¤„ç†ä¸æ•°æ®æ¸…æ´—</a></li><li><a href=/notebooks/langchain%E7%AC%94%E8%AE%B0/%E7%AC%AC%E4%B8%83%E7%AF%87-deep-agents/>ç¬¬ä¸ƒç¯‡ Deep Agents</a></li><li><a href=/notebooks/langchain%E7%AC%94%E8%AE%B0/%E7%AC%AC%E5%85%AB%E7%AF%87-middleware-%E5%B7%A5%E7%A8%8B%E5%8C%96/>ç¬¬å…«ç¯‡ Middleware å·¥ç¨‹åŒ–</a></li><li><a href=/notebooks/langchain%E7%AC%94%E8%AE%B0/%E7%AC%AC%E4%B9%9D%E7%AF%87-agent-%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1/>ç¬¬ä¹ç¯‡ Agent æ¶æ„è®¾è®¡</a></li><li><a href=/notebooks/langchain%E7%AC%94%E8%AE%B0/%E7%AC%AC%E5%8D%81%E7%AF%87-%E7%94%9F%E4%BA%A7%E5%AE%9E%E8%B7%B5%E4%B8%8E%E7%9B%91%E6%8E%A7%E8%AF%84%E4%BC%B0/>ç¬¬åç¯‡ ç”Ÿäº§å®è·µä¸ç›‘æ§è¯„ä¼°</a></li><li><input type=checkbox id=section-a3e9b1811e5a21dbfddb0753f565cedb class=toggle>
<label for=section-a3e9b1811e5a21dbfddb0753f565cedb class=flex><a role=button>assets</a>
<img src=/icons/chevron-right.svg class=book-icon alt=Expand></label><ul></ul></li><li><input type=checkbox id=section-9a64553a000534ad3c81a611c6c29ec2 class=toggle>
<label for=section-9a64553a000534ad3c81a611c6c29ec2 class=flex><a role=button>code</a>
<img src=/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><input type=checkbox id=section-6fad2589acfdd5d6a1fb55beb392fb77 class=toggle>
<label for=section-6fad2589acfdd5d6a1fb55beb392fb77 class=flex><a href=/notebooks/langchain%E7%AC%94%E8%AE%B0/code/fasta2a/>fasta2a</a>
<img src=/icons/chevron-right.svg class=book-icon alt=Expand></label><ul></ul></li></ul></li></ul></li><li><input type=checkbox id=section-ce33306d44f9ed4d296b9a79329bed1c class=toggle>
<label for=section-ce33306d44f9ed4d296b9a79329bed1c class=flex><a role=button>å›¾åƒç®—æ³•ç¬”è®°</a>
<img src=/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/notebooks/%E5%9B%BE%E5%83%8F%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/%E7%AC%AC%E4%B8%80%E7%AF%87_%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80/>ç¬¬ä¸€ç¯‡ æœºå™¨å­¦ä¹ åŸºç¡€</a></li><li><a href=/notebooks/%E5%9B%BE%E5%83%8F%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/%E7%AC%AC%E4%BA%8C%E7%AF%87_%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80/>ç¬¬äºŒç¯‡ æ·±åº¦å­¦ä¹ åŸºç¡€</a></li><li><a href=/notebooks/%E5%9B%BE%E5%83%8F%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/%E7%AC%AC%E4%B8%89%E7%AF%87_%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%A7%86%E8%A7%89%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF/>ç¬¬ä¸‰ç¯‡ è®¡ç®—æœºè§†è§‰æ ¸å¿ƒæŠ€æœ¯</a></li><li><a href=/notebooks/%E5%9B%BE%E5%83%8F%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/%E7%AC%AC%E5%9B%9B%E7%AF%87_%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B%E4%B8%8Eyolo%E7%B3%BB%E5%88%97/>ç¬¬å››ç¯‡ ç›®æ ‡æ£€æµ‹ä¸YOLOç³»åˆ—</a></li><li><a href=/notebooks/%E5%9B%BE%E5%83%8F%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/%E7%AC%AC%E4%BA%94%E7%AF%87_%E5%9B%BE%E5%83%8F%E5%88%86%E5%89%B2/>ç¬¬äº”ç¯‡ å›¾åƒåˆ†å‰²</a></li><li><a href=/notebooks/%E5%9B%BE%E5%83%8F%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/%E7%AC%AC%E5%85%AD%E7%AF%87_%E7%94%9F%E6%88%90%E6%A8%A1%E5%9E%8B/>ç¬¬å…­ç¯‡ ç”Ÿæˆæ¨¡å‹</a></li><li><a href=/notebooks/%E5%9B%BE%E5%83%8F%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/%E7%AC%AC%E4%B8%83%E7%AF%87_%E8%A7%86%E8%A7%89%E5%A4%A7%E6%A8%A1%E5%9E%8B/>ç¬¬ä¸ƒç¯‡ è§†è§‰å¤§æ¨¡å‹</a></li><li><a href=/notebooks/%E5%9B%BE%E5%83%8F%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/%E7%AC%AC%E5%85%AB%E7%AF%87_%E7%94%9F%E4%BA%A7%E5%AE%9E%E8%B7%B5/>ç¬¬å…«ç¯‡ ç”Ÿäº§å®è·µ</a></li></ul></li><li><input type=checkbox id=section-77f5db9e44a9af6dab4403b49a65334f class=toggle>
<label for=section-77f5db9e44a9af6dab4403b49a65334f class=flex><a href=/notebooks/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E7%AC%94%E8%AE%B0/>å¤§æ¨¡å‹ç¬”è®°</a>
<img src=/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><input type=checkbox id=section-db59738de306cbbe384ad7fbd5cf11b5 class=toggle>
<label for=section-db59738de306cbbe384ad7fbd5cf11b5 class=flex><a role=button>ç¬¬ä¸€éƒ¨åˆ†ï¼šå¤§è¯­è¨€æ¨¡å‹åŸºç¡€</a>
<img src=/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/notebooks/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E7%AC%94%E8%AE%B0/%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86%E5%A4%A7%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E5%9F%BA%E7%A1%80/%E7%AC%AC1%E7%AB%A0_%E5%88%9D%E8%AF%86%E5%A4%A7%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B/>ç¬¬1ç«  åˆè¯†å¤§è¯­è¨€æ¨¡å‹</a></li><li><a href=/notebooks/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E7%AC%94%E8%AE%B0/%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86%E5%A4%A7%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E5%9F%BA%E7%A1%80/%E7%AC%AC2%E7%AB%A0_%E4%B8%8E%E6%A8%A1%E5%9E%8B%E5%AF%B9%E8%AF%9D%E6%8F%90%E7%A4%BA%E5%B7%A5%E7%A8%8B%E5%9F%BA%E7%A1%80/>ç¬¬2ç«  ä¸æ¨¡å‹å¯¹è¯ï¼šæç¤ºå·¥ç¨‹åŸºç¡€</a></li><li><a href=/notebooks/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E7%AC%94%E8%AE%B0/%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86%E5%A4%A7%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E5%9F%BA%E7%A1%80/%E7%AC%AC3%E7%AB%A0_%E8%AF%AD%E8%A8%80%E7%9A%84%E5%9F%BA%E7%9F%B3%E5%88%86%E8%AF%8D%E4%B8%8E%E5%B5%8C%E5%85%A5/>ç¬¬3ç«  è¯­è¨€çš„åŸºçŸ³ï¼šåˆ†è¯ä¸åµŒå…¥</a></li></ul></li><li><input type=checkbox id=section-30b17899e420f6a53aa6e578440dd132 class=toggle>
<label for=section-30b17899e420f6a53aa6e578440dd132 class=flex><a role=button>ç¬¬äºŒéƒ¨åˆ†ï¼šTransformeræ¶æ„æ­ç§˜</a>
<img src=/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/notebooks/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E7%AC%94%E8%AE%B0/%E7%AC%AC%E4%BA%8C%E9%83%A8%E5%88%86transformer%E6%9E%B6%E6%9E%84%E6%8F%AD%E7%A7%98/%E7%AC%AC1%E7%AB%A0_transformer%E6%A0%B8%E5%BF%83%E6%8F%AD%E7%A7%98/>ç¬¬1ç«  Transformeræ ¸å¿ƒæ­ç§˜</a></li><li><a href=/notebooks/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E7%AC%94%E8%AE%B0/%E7%AC%AC%E4%BA%8C%E9%83%A8%E5%88%86transformer%E6%9E%B6%E6%9E%84%E6%8F%AD%E7%A7%98/%E7%AC%AC2%E7%AB%A0_%E6%A8%A1%E5%9E%8B%E5%AE%B6%E6%97%8F%E8%B0%B1%E7%B3%BB%E4%BB%8E%E7%BC%96%E7%A0%81%E5%99%A8%E5%88%B0%E8%A7%A3%E7%A0%81%E5%99%A8/>ç¬¬2ç«  æ¨¡å‹å®¶æ—è°±ç³»ï¼šä»ç¼–ç å™¨åˆ°è§£ç å™¨</a></li><li><a href=/notebooks/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E7%AC%94%E8%AE%B0/%E7%AC%AC%E4%BA%8C%E9%83%A8%E5%88%86transformer%E6%9E%B6%E6%9E%84%E6%8F%AD%E7%A7%98/%E7%AC%AC3%E7%AB%A0_%E9%A2%84%E8%AE%AD%E7%BB%83%E7%9A%84%E5%A5%A5%E7%A7%98%E4%BB%8E%E6%95%B0%E6%8D%AE%E5%88%B0%E6%99%BA%E8%83%BD/>ç¬¬3ç«  é¢„è®­ç»ƒçš„å¥¥ç§˜ï¼šä»æ•°æ®åˆ°æ™ºèƒ½</a></li></ul></li><li><input type=checkbox id=section-da88ac5e3d01ea6f4b2996cb87ecf19f class=toggle>
<label for=section-da88ac5e3d01ea6f4b2996cb87ecf19f class=flex><a role=button>ç¬¬ä¸‰éƒ¨åˆ†ï¼šæ•°æ®å·¥ç¨‹ä¸å®šåˆ¶åŒ–</a>
<img src=/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/notebooks/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E7%AC%94%E8%AE%B0/%E7%AC%AC%E4%B8%89%E9%83%A8%E5%88%86%E6%95%B0%E6%8D%AE%E5%B7%A5%E7%A8%8B%E4%B8%8E%E5%AE%9A%E5%88%B6%E5%8C%96/%E7%AC%AC1%E7%AB%A0_%E6%95%B0%E6%8D%AE%E5%B7%A5%E7%A8%8B%E5%9F%BA%E7%A1%80/>ç¬¬1ç«  æ•°æ®å·¥ç¨‹åŸºç¡€</a></li><li><a href=/notebooks/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E7%AC%94%E8%AE%B0/%E7%AC%AC%E4%B8%89%E9%83%A8%E5%88%86%E6%95%B0%E6%8D%AE%E5%B7%A5%E7%A8%8B%E4%B8%8E%E5%AE%9A%E5%88%B6%E5%8C%96/%E7%AC%AC2%E7%AB%A0_%E5%BE%AE%E8%B0%83%E4%BD%A0%E7%9A%84%E4%B8%93%E5%B1%9E%E6%A8%A1%E5%9E%8B/>ç¬¬2ç«  å¾®è°ƒä½ çš„ä¸“å±æ¨¡å‹</a></li><li><a href=/notebooks/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E7%AC%94%E8%AE%B0/%E7%AC%AC%E4%B8%89%E9%83%A8%E5%88%86%E6%95%B0%E6%8D%AE%E5%B7%A5%E7%A8%8B%E4%B8%8E%E5%AE%9A%E5%88%B6%E5%8C%96/%E7%AC%AC3%E7%AB%A0_%E4%B8%8E%E4%BA%BA%E7%B1%BB%E5%AF%B9%E9%BD%90%E5%81%8F%E5%A5%BD%E4%BC%98%E5%8C%96/>ç¬¬3ç«  ä¸äººç±»å¯¹é½ï¼šåå¥½ä¼˜åŒ–</a></li><li><a href=/notebooks/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E7%AC%94%E8%AE%B0/%E7%AC%AC%E4%B8%89%E9%83%A8%E5%88%86%E6%95%B0%E6%8D%AE%E5%B7%A5%E7%A8%8B%E4%B8%8E%E5%AE%9A%E5%88%B6%E5%8C%96/%E7%AC%AC4%E7%AB%A0_%E5%88%9B%E5%BB%BA%E6%9B%B4%E4%BC%98%E7%9A%84%E5%B5%8C%E5%85%A5%E6%A8%A1%E5%9E%8B/>ç¬¬4ç«  åˆ›å»ºæ›´ä¼˜çš„åµŒå…¥æ¨¡å‹</a></li></ul></li><li><input type=checkbox id=section-81f0a7a10bc544ea0e1fd883e2a436eb class=toggle>
<label for=section-81f0a7a10bc544ea0e1fd883e2a436eb class=flex><a role=button>ç¬¬å››éƒ¨åˆ†ï¼šå¤§æ¨¡å‹åº”ç”¨å¼€å‘</a>
<img src=/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/notebooks/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E7%AC%94%E8%AE%B0/%E7%AC%AC%E5%9B%9B%E9%83%A8%E5%88%86%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91/%E7%AC%AC1%E7%AB%A0_%E6%8F%90%E7%A4%BA%E5%B7%A5%E7%A8%8B%E4%B8%8E%E4%B8%8A%E4%B8%8B%E6%96%87%E5%AD%A6%E4%B9%A0/>ç¬¬1ç«  æç¤ºå·¥ç¨‹ä¸ä¸Šä¸‹æ–‡å­¦ä¹ </a></li><li><a href=/notebooks/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E7%AC%94%E8%AE%B0/%E7%AC%AC%E5%9B%9B%E9%83%A8%E5%88%86%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91/%E7%AC%AC2%E7%AB%A0_%E6%A3%80%E7%B4%A2%E5%A2%9E%E5%BC%BA%E7%94%9F%E6%88%90rag%E5%8E%9F%E7%90%86/>ç¬¬2ç«  æ£€ç´¢å¢å¼ºç”Ÿæˆï¼ˆRAGï¼‰åŸç†</a></li><li><a href=/notebooks/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E7%AC%94%E8%AE%B0/%E7%AC%AC%E5%9B%9B%E9%83%A8%E5%88%86%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91/%E7%AC%AC3%E7%AB%A0_%E6%99%BA%E8%83%BD%E4%BD%93agent%E6%A0%B8%E5%BF%83%E6%9C%BA%E5%88%B6/>ç¬¬3ç«  æ™ºèƒ½ä½“ï¼ˆAgentï¼‰æ ¸å¿ƒæœºåˆ¶</a></li><li><a href=/notebooks/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E7%AC%94%E8%AE%B0/%E7%AC%AC%E5%9B%9B%E9%83%A8%E5%88%86%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91/%E7%AC%AC4%E7%AB%A0_%E5%A4%9A%E6%A8%A1%E6%80%81%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%8E%9F%E7%90%86/>ç¬¬4ç«  å¤šæ¨¡æ€å¤§æ¨¡å‹åŸç†</a></li></ul></li><li><input type=checkbox id=section-0509decfe880d3d2074947902aea8022 class=toggle>
<label for=section-0509decfe880d3d2074947902aea8022 class=flex><a role=button>ç¬¬äº”éƒ¨åˆ†ï¼šå·¥ç¨‹å®æˆ˜å·¥å…·æ ˆ</a>
<img src=/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/notebooks/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E7%AC%94%E8%AE%B0/%E7%AC%AC%E4%BA%94%E9%83%A8%E5%88%86%E5%B7%A5%E7%A8%8B%E5%AE%9E%E6%88%98%E5%B7%A5%E5%85%B7%E6%A0%88/%E7%AC%AC1%E7%AB%A0_hugging_face%E7%94%9F%E6%80%81%E5%85%A8%E6%99%AF/>ç¬¬1ç«  Hugging Faceç”Ÿæ€å…¨æ™¯</a></li><li><a href=/notebooks/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E7%AC%94%E8%AE%B0/%E7%AC%AC%E4%BA%94%E9%83%A8%E5%88%86%E5%B7%A5%E7%A8%8B%E5%AE%9E%E6%88%98%E5%B7%A5%E5%85%B7%E6%A0%88/%E7%AC%AC2%E7%AB%A0_llama-factory%E5%BE%AE%E8%B0%83%E5%B7%A5%E5%8E%82/>ç¬¬2ç«  LLaMA-Factoryå¾®è°ƒå·¥å‚</a></li><li><a href=/notebooks/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E7%AC%94%E8%AE%B0/%E7%AC%AC%E4%BA%94%E9%83%A8%E5%88%86%E5%B7%A5%E7%A8%8B%E5%AE%9E%E6%88%98%E5%B7%A5%E5%85%B7%E6%A0%88/%E7%AC%AC3%E7%AB%A0_trl%E4%B8%8E%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E5%AE%9E%E6%88%98/>ç¬¬3ç«  TRLä¸å¼ºåŒ–å­¦ä¹ å®æˆ˜</a></li><li><a href=/notebooks/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E7%AC%94%E8%AE%B0/%E7%AC%AC%E4%BA%94%E9%83%A8%E5%88%86%E5%B7%A5%E7%A8%8B%E5%AE%9E%E6%88%98%E5%B7%A5%E5%85%B7%E6%A0%88/%E7%AC%AC4%E7%AB%A0_deepspeed%E5%88%86%E5%B8%83%E5%BC%8F%E8%AE%AD%E7%BB%83/>ç¬¬4ç«  DeepSpeedåˆ†å¸ƒå¼è®­ç»ƒ</a></li><li><a href=/notebooks/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E7%AC%94%E8%AE%B0/%E7%AC%AC%E4%BA%94%E9%83%A8%E5%88%86%E5%B7%A5%E7%A8%8B%E5%AE%9E%E6%88%98%E5%B7%A5%E5%85%B7%E6%A0%88/%E7%AC%AC5%E7%AB%A0_%E7%AB%AF%E5%88%B0%E7%AB%AFllm%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/>ç¬¬5ç«  ç«¯åˆ°ç«¯LLMé¡¹ç›®å®æˆ˜</a></li></ul></li><li><input type=checkbox id=section-dc465ed94a0f7fb78440cab8a8a2a28b class=toggle>
<label for=section-dc465ed94a0f7fb78440cab8a8a2a28b class=flex><a role=button>ç¬¬å…­éƒ¨åˆ†ï¼šç”Ÿäº§éƒ¨ç½²ä¸è¯„ä¼°</a>
<img src=/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/notebooks/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E7%AC%94%E8%AE%B0/%E7%AC%AC%E5%85%AD%E9%83%A8%E5%88%86%E7%94%9F%E4%BA%A7%E9%83%A8%E7%BD%B2%E4%B8%8E%E8%AF%84%E4%BC%B0/%E7%AC%AC1%E7%AB%A0_%E6%A8%A1%E5%9E%8B%E5%8E%8B%E7%BC%A9%E4%B8%8E%E6%8E%A8%E7%90%86%E5%8A%A0%E9%80%9F/>ç¬¬1ç«  æ¨¡å‹å‹ç¼©ä¸æ¨ç†åŠ é€Ÿ</a></li><li><a href=/notebooks/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E7%AC%94%E8%AE%B0/%E7%AC%AC%E5%85%AD%E9%83%A8%E5%88%86%E7%94%9F%E4%BA%A7%E9%83%A8%E7%BD%B2%E4%B8%8E%E8%AF%84%E4%BC%B0/%E7%AC%AC2%E7%AB%A0_vllm%E9%AB%98%E6%80%A7%E8%83%BD%E6%8E%A8%E7%90%86/>ç¬¬2ç«  vLLMé«˜æ€§èƒ½æ¨ç†</a></li><li><a href=/notebooks/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E7%AC%94%E8%AE%B0/%E7%AC%AC%E5%85%AD%E9%83%A8%E5%88%86%E7%94%9F%E4%BA%A7%E9%83%A8%E7%BD%B2%E4%B8%8E%E8%AF%84%E4%BC%B0/%E7%AC%AC3%E7%AB%A0_%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BC%B0%E4%BD%93%E7%B3%BB/>ç¬¬3ç«  æ¨¡å‹è¯„ä¼°ä½“ç³»</a></li></ul></li><li><input type=checkbox id=section-54ec04ac2cdda7238de2ed38f0bcb7b1 class=toggle>
<label for=section-54ec04ac2cdda7238de2ed38f0bcb7b1 class=flex><a role=button>ç¬¬ä¸ƒéƒ¨åˆ†ï¼šé«˜çº§æŠ€æœ¯ä¸“é¢˜</a>
<img src=/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/notebooks/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E7%AC%94%E8%AE%B0/%E7%AC%AC%E4%B8%83%E9%83%A8%E5%88%86%E9%AB%98%E7%BA%A7%E6%8A%80%E6%9C%AF%E4%B8%93%E9%A2%98/%E7%AC%AC1%E7%AB%A0_%E9%95%BF%E4%B8%8A%E4%B8%8B%E6%96%87%E6%8A%80%E6%9C%AF/>ç¬¬1ç«  é•¿ä¸Šä¸‹æ–‡æŠ€æœ¯</a></li><li><a href=/notebooks/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E7%AC%94%E8%AE%B0/%E7%AC%AC%E4%B8%83%E9%83%A8%E5%88%86%E9%AB%98%E7%BA%A7%E6%8A%80%E6%9C%AF%E4%B8%93%E9%A2%98/%E7%AC%AC2%E7%AB%A0_%E6%96%B0%E5%9E%8B%E6%9E%B6%E6%9E%84%E6%8E%A2%E7%B4%A2/>ç¬¬2ç«  æ–°å‹æ¶æ„æ¢ç´¢</a></li><li><a href=/notebooks/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E7%AC%94%E8%AE%B0/%E7%AC%AC%E4%B8%83%E9%83%A8%E5%88%86%E9%AB%98%E7%BA%A7%E6%8A%80%E6%9C%AF%E4%B8%93%E9%A2%98/%E7%AC%AC3%E7%AB%A0_%E6%8E%A8%E7%90%86%E5%8A%A0%E9%80%9F%E9%BB%91%E7%A7%91%E6%8A%80/>ç¬¬3ç«  æ¨ç†åŠ é€Ÿé»‘ç§‘æŠ€</a></li><li><a href=/notebooks/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E7%AC%94%E8%AE%B0/%E7%AC%AC%E4%B8%83%E9%83%A8%E5%88%86%E9%AB%98%E7%BA%A7%E6%8A%80%E6%9C%AF%E4%B8%93%E9%A2%98/%E7%AC%AC4%E7%AB%A0_%E6%8E%A8%E7%90%86%E6%A8%A1%E5%9E%8B%E4%B8%93%E9%A2%98/>ç¬¬4ç«  æ¨ç†æ¨¡å‹ä¸“é¢˜</a></li><li><a href=/notebooks/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E7%AC%94%E8%AE%B0/%E7%AC%AC%E4%B8%83%E9%83%A8%E5%88%86%E9%AB%98%E7%BA%A7%E6%8A%80%E6%9C%AF%E4%B8%93%E9%A2%98/%E7%AC%AC5%E7%AB%A0_%E6%A8%A1%E5%9E%8B%E5%AE%89%E5%85%A8%E4%B8%8E%E5%8F%AF%E8%A7%A3%E9%87%8A%E6%80%A7/>ç¬¬5ç«  æ¨¡å‹å®‰å…¨ä¸å¯è§£é‡Šæ€§</a></li></ul></li><li><a href=/notebooks/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E7%AC%94%E8%AE%B0/glossary/>GLOSSARY</a></li><li><a href=/notebooks/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E7%AC%94%E8%AE%B0/roadmap/>ROADMAP</a></li><li><a href=/notebooks/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E7%AC%94%E8%AE%B0/summary/>SUMMARY</a></li><li><a href=/notebooks/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E7%AC%94%E8%AE%B0/%E5%AE%8C%E7%BB%93%E6%8A%A5%E5%91%8A/>å®Œç»“æŠ¥å‘Š</a></li></ul></li><li><input type=checkbox id=section-7177254393287994b491879262a62a06 class=toggle>
<label for=section-7177254393287994b491879262a62a06 class=flex><a role=button>å®è·µç¬”è®°</a>
<img src=/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/notebooks/%E5%AE%9E%E8%B7%B5%E7%AC%94%E8%AE%B0/2.-%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3-fastapi/>æ·±å…¥ç†è§£ FastAPI</a></li><li><a href=/notebooks/%E5%AE%9E%E8%B7%B5%E7%AC%94%E8%AE%B0/4.-agent%E6%9C%80%E4%BD%B3%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/>Agentæœ€ä½³è®¾è®¡æ¨¡å¼</a></li></ul></li><li><input type=checkbox id=section-0172eb8516eeb7b4e657f3949a135c25 class=toggle>
<label for=section-0172eb8516eeb7b4e657f3949a135c25 class=flex><a role=button>æœºå™¨å­¦ä¹ ç¬”è®°</a>
<img src=/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/notebooks/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E7%AC%AC01%E7%AB%A0_%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%A6%82%E8%A7%88/>ç¬¬01ç«  æœºå™¨å­¦ä¹ æ¦‚è§ˆ</a></li><li><a href=/notebooks/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E7%AC%AC02%E7%AB%A0_%E7%9F%A9%E9%98%B5%E8%BF%90%E7%AE%97%E4%B8%8E%E5%BE%AE%E7%A7%AF%E5%88%86/>ç¬¬02ç«  çŸ©é˜µè¿ç®—ä¸å¾®ç§¯åˆ†</a></li><li><a href=/notebooks/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E7%AC%AC03%E7%AB%A0_svd%E4%B8%8E%E7%9F%A9%E9%98%B5%E5%88%86%E8%A7%A3/>ç¬¬03ç«  SVDä¸çŸ©é˜µåˆ†è§£</a></li><li><a href=/notebooks/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E7%AC%AC04%E7%AB%A0_%E6%A6%82%E7%8E%87%E5%88%86%E5%B8%83_%E6%8C%87%E6%95%B0%E6%97%8F%E4%B8%8E%E5%85%B1%E8%BD%AD%E5%85%88%E9%AA%8C/>ç¬¬04ç«  æ¦‚ç‡åˆ†å¸ƒ æŒ‡æ•°æ—ä¸å…±è½­å…ˆéªŒ</a></li><li><a href=/notebooks/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E7%AC%AC05%E7%AB%A0_%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/>ç¬¬05ç«  çº¿æ€§å›å½’</a></li><li><a href=/notebooks/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E7%AC%AC06%E7%AB%A0_%E6%84%9F%E7%9F%A5%E6%9C%BA/>ç¬¬06ç«  æ„ŸçŸ¥æœº</a></li><li><a href=/notebooks/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E7%AC%AC07%E7%AB%A0_%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BAsvm/>ç¬¬07ç«  æ”¯æŒå‘é‡æœº(SVM)</a></li><li><a href=/notebooks/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E7%AC%AC08%E7%AB%A0_%E6%A0%B8%E6%96%B9%E6%B3%95/>ç¬¬08ç«  æ ¸æ–¹æ³•</a></li><li><a href=/notebooks/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E7%AC%AC09%E7%AB%A0_%E5%86%B3%E7%AD%96%E6%A0%91%E4%B8%8E%E9%9B%86%E6%88%90%E5%AD%A6%E4%B9%A0/>ç¬¬09ç«  å†³ç­–æ ‘ä¸é›†æˆå­¦ä¹ </a></li><li><a href=/notebooks/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E7%AC%AC10%E7%AB%A0_%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92%E4%B8%8E%E6%9C%80%E5%A4%A7%E7%86%B5%E6%A8%A1%E5%9E%8B/>ç¬¬10ç«  é€»è¾‘å›å½’ä¸æœ€å¤§ç†µæ¨¡å‹</a></li><li><a href=/notebooks/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E7%AC%AC11%E7%AB%A0_%E5%B9%BF%E4%B9%89%E7%BA%BF%E6%80%A7%E6%A8%A1%E5%9E%8Bglm/>ç¬¬11ç«  å¹¿ä¹‰çº¿æ€§æ¨¡å‹(GLM)</a></li><li><a href=/notebooks/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E7%AC%AC13%E7%AB%A0_%E6%A6%82%E7%8E%87%E5%9B%BE%E6%A8%A1%E5%9E%8B_%E8%A1%A8%E7%A4%BA/>ç¬¬13ç«  æ¦‚ç‡å›¾æ¨¡å‹ è¡¨ç¤º</a></li><li><a href=/notebooks/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E7%AC%AC14%E7%AB%A0_%E6%A6%82%E7%8E%87%E5%9B%BE%E6%A8%A1%E5%9E%8B_%E6%8E%A8%E6%96%AD/>ç¬¬14ç«  æ¦‚ç‡å›¾æ¨¡å‹ æ¨æ–­</a></li><li><input type=checkbox id=section-b17efd79c46843a887113a063f929150 class=toggle>
<label for=section-b17efd79c46843a887113a063f929150 class=flex><a role=button>assets</a>
<img src=/icons/chevron-right.svg class=book-icon alt=Expand></label><ul></ul></li><li><a href=/notebooks/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/skills/>skills</a></li></ul></li><li><input type=checkbox id=section-29762f225235d2ac19b613cc28b093c8 class=toggle>
<label for=section-29762f225235d2ac19b613cc28b093c8 class=flex><a href=/notebooks/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/>æ·±åº¦å­¦ä¹ ç¬”è®°</a>
<img src=/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/notebooks/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E7%AC%AC1%E7%AB%A0_%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80/>ç¬¬1ç«  æ·±åº¦å­¦ä¹ åŸºç¡€</a></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class="book-header hidden"><div class="flex align-center justify-between"><label for=menu-control><img src=/icons/menu.svg class=book-icon alt=Menu></label><h3>ç¬¬äº”ç¯‡ RAGé«˜çº§ç¯‡(LlamaIndexç¯‡)</h3><label for=toc-control><img src=/icons/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class=hidden><nav id=TableOfContents><ul><li><a href=#-å‰ç½®å‡†å¤‡>ğŸ“‹ å‰ç½®å‡†å¤‡</a></li><li><a href=#ç¬¬1ç« æ··åˆæ£€ç´¢-hybrid-retrieval>ç¬¬1ç« ï¼šæ··åˆæ£€ç´¢ (Hybrid Retrieval)</a><ul><li><a href=#11-ä¸ºä»€ä¹ˆéœ€è¦æ··åˆæ£€ç´¢>1.1 ä¸ºä»€ä¹ˆéœ€è¦æ··åˆæ£€ç´¢ï¼Ÿ</a></li><li><a href=#12-å®æˆ˜æ„å»ºæ··åˆæ£€ç´¢å™¨>1.2 å®æˆ˜ï¼šæ„å»ºæ··åˆæ£€ç´¢å™¨</a></li></ul></li><li><a href=#ç¬¬2ç« æŸ¥è¯¢ä¼˜åŒ–ä¸è·¯ç”±-routing--transformation>ç¬¬2ç« ï¼šæŸ¥è¯¢ä¼˜åŒ–ä¸è·¯ç”± (Routing & Transformation)</a><ul><li><a href=#21-router-query-engine-è‡ªåŠ¨è·¯ç”±>2.1 Router Query Engine (è‡ªåŠ¨è·¯ç”±)</a></li><li><a href=#22-hyde-å‡è®¾æ€§æ–‡æ¡£åµŒå…¥>2.2 HyDE (å‡è®¾æ€§æ–‡æ¡£åµŒå…¥)</a></li></ul></li><li><a href=#ç¬¬3ç« é‡æ’åºæŠ€æœ¯-reranking>ç¬¬3ç« ï¼šé‡æ’åºæŠ€æœ¯ (Reranking)</a><ul><li><a href=#31-cohere-rerank-å®æˆ˜>3.1 Cohere Rerank å®æˆ˜</a></li></ul></li><li><a href=#ç¬¬4ç« chat-engine-å¤šè½®å¯¹è¯>ç¬¬4ç« ï¼šChat Engine (å¤šè½®å¯¹è¯)</a><ul><li><a href=#41-condense-plus-context-mode-æœ€ä½³å®è·µ>4.1 Condense Plus Context Mode (æœ€ä½³å®è·µ)</a></li></ul></li><li><a href=#ç¬¬5ç« çŸ¥è¯†å›¾è°±-rag-graphrag>ç¬¬5ç« ï¼šçŸ¥è¯†å›¾è°± RAG (GraphRAG)</a><ul><li><a href=#51-propertygraphindex-æ„å»º>5.1 PropertyGraphIndex æ„å»º</a></li></ul></li><li><a href=#ç¬¬6ç« agent-ä¸-rag-çš„ç»ˆæèåˆ>ç¬¬6ç« ï¼šAgent ä¸ RAG çš„ç»ˆæèåˆ</a><ul><li><a href=#61-rag-as-a-tool>6.1 RAG as a Tool</a></li></ul></li><li><a href=#ç¬¬7ç« æ€»ç»“ä¸å±•æœ›>ç¬¬7ç« ï¼šæ€»ç»“ä¸å±•æœ›</a><ul><li><a href=#71-llamaindex-æ ¸å¿ƒèƒ½åŠ›å¤§å›¾>7.1 LlamaIndex æ ¸å¿ƒèƒ½åŠ›å¤§å›¾</a></li><li><a href=#72-è¿›é˜¶å­¦ä¹ è·¯çº¿>7.2 è¿›é˜¶å­¦ä¹ è·¯çº¿</a></li></ul></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=ç¬¬äº”ç¯‡-ragé«˜çº§ç¯‡-llamaindex>ç¬¬äº”ç¯‡ RAGé«˜çº§ç¯‡ (LlamaIndex)<a class=anchor href=#%e7%ac%ac%e4%ba%94%e7%af%87-rag%e9%ab%98%e7%ba%a7%e7%af%87-llamaindex>#</a></h1><blockquote class=book-hint><p><strong>ç›®æ ‡</strong>: åœ¨æŒæ¡ LlamaIndex åŸºç¡€ç»„ä»¶ï¼ˆIndex, Retriever, QueryEngineï¼‰çš„åŸºç¡€ä¸Šï¼Œæ·±å…¥å­¦ä¹ å…¶"æ€æ‰‹é”"çº§çš„é«˜çº§æ£€ç´¢ç­–ç•¥ä¸ Agent é›†æˆèƒ½åŠ›ã€‚æœ¬ç¯‡å°†å¸¦ä½ ä»"èƒ½ç”¨"è¿›åŒ–åˆ°"å¥½ç”¨"ã€‚</p></blockquote><h2 id=-å‰ç½®å‡†å¤‡>ğŸ“‹ å‰ç½®å‡†å¤‡<a class=anchor href=#-%e5%89%8d%e7%bd%ae%e5%87%86%e5%a4%87>#</a></h2><p>æœ¬ç¯‡åŸºäº LlamaIndex v0.10+ ç‰ˆæœ¬ï¼Œå»ºè®®å…ˆå®Œæˆç¬¬å››ç¯‡çš„ç¯å¢ƒé…ç½®ã€‚</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># å®‰è£…é«˜çº§ç»„ä»¶ä¾èµ–</span>
</span></span><span class=line><span class=cl>pip install llama-index-retrievers-bm25
</span></span><span class=line><span class=cl>pip install llama-index-postprocessor-cohere-rerank
</span></span><span class=line><span class=cl>pip install llama-index-graph-stores-neo4j
</span></span><span class=line><span class=cl>pip install llama-parse</span></span></code></pre></div><hr><h2 id=ç¬¬1ç« æ··åˆæ£€ç´¢-hybrid-retrieval>ç¬¬1ç« ï¼šæ··åˆæ£€ç´¢ (Hybrid Retrieval)<a class=anchor href=#%e7%ac%ac1%e7%ab%a0%e6%b7%b7%e5%90%88%e6%a3%80%e7%b4%a2-hybrid-retrieval>#</a></h2><p>å•ä¸€çš„å‘é‡æ£€ç´¢ï¼ˆSemantic Searchï¼‰åœ¨å¤„ç†ç²¾ç¡®å…³é”®è¯åŒ¹é…ï¼ˆå¦‚äº§å“å‹å·ã€ä¸“æœ‰åè¯ï¼‰æ—¶å¾€å¾€è¡¨ç°ä¸ä½³ã€‚æ··åˆæ£€ç´¢é€šè¿‡ç»“åˆ <strong>BM25ï¼ˆå…³é”®è¯ï¼‰</strong> å’Œ <strong>Vectorï¼ˆè¯­ä¹‰ï¼‰</strong>ï¼Œäº’è¡¥é•¿çŸ­ã€‚</p><h3 id=11-ä¸ºä»€ä¹ˆéœ€è¦æ··åˆæ£€ç´¢>1.1 ä¸ºä»€ä¹ˆéœ€è¦æ··åˆæ£€ç´¢ï¼Ÿ<a class=anchor href=#11-%e4%b8%ba%e4%bb%80%e4%b9%88%e9%9c%80%e8%a6%81%e6%b7%b7%e5%90%88%e6%a3%80%e7%b4%a2>#</a></h3><ul><li><strong>å‘é‡æ£€ç´¢</strong>ï¼šæ“…é•¿ç†è§£"æ„å›¾"å’Œ"æ¦‚å¿µ"ã€‚ä¾‹å¦‚æœ"è‹¹æœæ‰‹æœº"ï¼Œèƒ½åŒ¹é…åˆ°"iPhone"ã€‚</li><li><strong>å…³é”®è¯æ£€ç´¢</strong>ï¼šæ“…é•¿ç²¾ç¡®åŒ¹é…ã€‚ä¾‹å¦‚æœ"é”™è¯¯ç  502"ï¼Œå‘é‡å¯èƒ½ä¼šåŒ¹é…åˆ°"ç½‘ç»œé”™è¯¯"ï¼Œä½† BM25 èƒ½ç²¾ç¡®å‘½ä¸­åŒ…å«"502"çš„æ–‡æ¡£ã€‚</li></ul><h3 id=12-å®æˆ˜æ„å»ºæ··åˆæ£€ç´¢å™¨>1.2 å®æˆ˜ï¼šæ„å»ºæ··åˆæ£€ç´¢å™¨<a class=anchor href=#12-%e5%ae%9e%e6%88%98%e6%9e%84%e5%bb%ba%e6%b7%b7%e5%90%88%e6%a3%80%e7%b4%a2%e5%99%a8>#</a></h3><p>LlamaIndex æä¾›äº† <code>QueryFusionRetriever</code> æ¥ä¼˜é›…åœ°èåˆå¤šç§æ£€ç´¢ç»“æœã€‚</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>llama_index.core</span> <span class=kn>import</span> <span class=n>VectorStoreIndex</span><span class=p>,</span> <span class=n>SimpleDirectoryReader</span><span class=p>,</span> <span class=n>StorageContext</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>llama_index.retrievers.bm25</span> <span class=kn>import</span> <span class=n>BM25Retriever</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>llama_index.core.retrievers</span> <span class=kn>import</span> <span class=n>QueryFusionRetriever</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>llama_index.core</span> <span class=kn>import</span> <span class=n>Settings</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 1. å‡†å¤‡æ•°æ®ä¸å‘é‡ç´¢å¼•</span>
</span></span><span class=line><span class=cl><span class=n>documents</span> <span class=o>=</span> <span class=n>SimpleDirectoryReader</span><span class=p>(</span><span class=s2>&#34;./data&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>load_data</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>vector_index</span> <span class=o>=</span> <span class=n>VectorStoreIndex</span><span class=o>.</span><span class=n>from_documents</span><span class=p>(</span><span class=n>documents</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2. åˆ›å»º BM25 æ£€ç´¢å™¨ (åŸºäºå…³é”®è¯)</span>
</span></span><span class=line><span class=cl><span class=c1># æ³¨æ„ï¼šBM25 éœ€è¦ docstore æ¥æ„å»ºå€’æ’ç´¢å¼•</span>
</span></span><span class=line><span class=cl><span class=n>bm25_retriever</span> <span class=o>=</span> <span class=n>BM25Retriever</span><span class=o>.</span><span class=n>from_defaults</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>docstore</span><span class=o>=</span><span class=n>vector_index</span><span class=o>.</span><span class=n>docstore</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>similarity_top_k</span><span class=o>=</span><span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 3. åˆ›å»º Vector æ£€ç´¢å™¨ (åŸºäºè¯­ä¹‰)</span>
</span></span><span class=line><span class=cl><span class=n>vector_retriever</span> <span class=o>=</span> <span class=n>vector_index</span><span class=o>.</span><span class=n>as_retriever</span><span class=p>(</span><span class=n>similarity_top_k</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 4. åˆ›å»ºèåˆæ£€ç´¢å™¨ (Hybrid)</span>
</span></span><span class=line><span class=cl><span class=n>hybrid_retriever</span> <span class=o>=</span> <span class=n>QueryFusionRetriever</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>retrievers</span><span class=o>=</span><span class=p>[</span><span class=n>vector_retriever</span><span class=p>,</span> <span class=n>bm25_retriever</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=n>num_queries</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>  <span class=c1># ä¸ç”Ÿæˆæ‰©å±•æŸ¥è¯¢ï¼Œä»…èåˆå½“å‰ç»“æœ</span>
</span></span><span class=line><span class=cl>    <span class=n>mode</span><span class=o>=</span><span class=s2>&#34;reciprocal_rerank&#34;</span><span class=p>,</span>  <span class=c1># ä½¿ç”¨ RRF (å€’æ•°æ’åèåˆ) ç®—æ³•</span>
</span></span><span class=line><span class=cl>    <span class=n>similarity_top_k</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>use_async</span><span class=o>=</span><span class=kc>True</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 5. æµ‹è¯•æ£€ç´¢</span>
</span></span><span class=line><span class=cl><span class=n>nodes</span> <span class=o>=</span> <span class=n>hybrid_retriever</span><span class=o>.</span><span class=n>retrieve</span><span class=p>(</span><span class=s2>&#34;LlamaIndex çš„è‡ªåŠ¨åˆå¹¶æ£€ç´¢åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>node</span> <span class=ow>in</span> <span class=n>nodes</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;å¾—åˆ†: </span><span class=si>{</span><span class=n>node</span><span class=o>.</span><span class=n>score</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2> | å†…å®¹: </span><span class=si>{</span><span class=n>node</span><span class=o>.</span><span class=n>text</span><span class=p>[:</span><span class=mi>50</span><span class=p>]</span><span class=si>}</span><span class=s2>...&#34;</span><span class=p>)</span></span></span></code></pre></div><hr><h2 id=ç¬¬2ç« æŸ¥è¯¢ä¼˜åŒ–ä¸è·¯ç”±-routing--transformation>ç¬¬2ç« ï¼šæŸ¥è¯¢ä¼˜åŒ–ä¸è·¯ç”± (Routing & Transformation)<a class=anchor href=#%e7%ac%ac2%e7%ab%a0%e6%9f%a5%e8%af%a2%e4%bc%98%e5%8c%96%e4%b8%8e%e8%b7%af%e7%94%b1-routing--transformation>#</a></h2><p>ç”¨æˆ·çš„ Query å¾€å¾€æ˜¯ä¸å®Œç¾çš„ï¼ˆæ¨¡ç³Šã€å¤æ‚ã€ç¼ºå¤±ä¸Šä¸‹æ–‡ï¼‰ã€‚LlamaIndex æä¾›äº†ä¸€ç³»åˆ—å·¥å…·æ¥"ä¿®å¤"æˆ–"åˆ†å‘"ç”¨æˆ·çš„æŸ¥è¯¢ã€‚</p><h3 id=21-router-query-engine-è‡ªåŠ¨è·¯ç”±>2.1 Router Query Engine (è‡ªåŠ¨è·¯ç”±)<a class=anchor href=#21-router-query-engine-%e8%87%aa%e5%8a%a8%e8%b7%af%e7%94%b1>#</a></h3><p>è¿™æ˜¯ LlamaIndex æœ€å¼ºå¤§çš„ Pattern ä¹‹ä¸€ï¼šè®© LLM å†³å®šæŸ¥å“ªä¸ªåº“ã€‚</p><ul><li><strong>åœºæ™¯</strong>ï¼š<ul><li>Query: &ldquo;æ€»ç»“å…¨æ–‡&rdquo; -> è·¯ç”±åˆ° <strong>SummaryIndex</strong></li><li>Query: &ldquo;ä½œè€…æ˜¯è°ï¼Ÿ&rdquo; -> è·¯ç”±åˆ° <strong>VectorStoreIndex</strong></li></ul></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>llama_index.core.tools</span> <span class=kn>import</span> <span class=n>QueryEngineTool</span><span class=p>,</span> <span class=n>ToolMetadata</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>llama_index.core.query_engine</span> <span class=kn>import</span> <span class=n>RouterQueryEngine</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>llama_index.core.selectors</span> <span class=kn>import</span> <span class=n>LLMSingleSelector</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>llama_index.core</span> <span class=kn>import</span> <span class=n>SummaryIndex</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 1. æ„å»ºä¸¤ä¸ªç´¢å¼•</span>
</span></span><span class=line><span class=cl><span class=n>summary_index</span> <span class=o>=</span> <span class=n>SummaryIndex</span><span class=o>.</span><span class=n>from_documents</span><span class=p>(</span><span class=n>documents</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>vector_index</span> <span class=o>=</span> <span class=n>VectorStoreIndex</span><span class=o>.</span><span class=n>from_documents</span><span class=p>(</span><span class=n>documents</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2. å°è£…ä¸ºå·¥å…·</span>
</span></span><span class=line><span class=cl><span class=n>summary_tool</span> <span class=o>=</span> <span class=n>QueryEngineTool</span><span class=o>.</span><span class=n>from_defaults</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>query_engine</span><span class=o>=</span><span class=n>summary_index</span><span class=o>.</span><span class=n>as_query_engine</span><span class=p>(</span><span class=n>response_mode</span><span class=o>=</span><span class=s2>&#34;tree_summarize&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=n>description</span><span class=o>=</span><span class=s2>&#34;ç”¨äºå›ç­”å…³äºæ–‡æ¡£æ•´ä½“æ‘˜è¦ã€å¤§çº²ã€æ€»ç»“ç±»çš„é—®é¢˜&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>vector_tool</span> <span class=o>=</span> <span class=n>QueryEngineTool</span><span class=o>.</span><span class=n>from_defaults</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>query_engine</span><span class=o>=</span><span class=n>vector_index</span><span class=o>.</span><span class=n>as_query_engine</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>    <span class=n>description</span><span class=o>=</span><span class=s2>&#34;ç”¨äºå›ç­”å…³äºæ–‡æ¡£ä¸­å…·ä½“äº‹å®ã€ç»†èŠ‚ã€å®šä¹‰çš„ç²¾ç¡®é—®é¢˜&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 3. æ„å»º Router (å¤§è„‘)</span>
</span></span><span class=line><span class=cl><span class=n>router_query_engine</span> <span class=o>=</span> <span class=n>RouterQueryEngine</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>selector</span><span class=o>=</span><span class=n>LLMSingleSelector</span><span class=o>.</span><span class=n>from_defaults</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>    <span class=n>query_engine_tools</span><span class=o>=</span><span class=p>[</span><span class=n>summary_tool</span><span class=p>,</span> <span class=n>vector_tool</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=n>verbose</span><span class=o>=</span><span class=kc>True</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 4. æµ‹è¯•è‡ªé€‚åº”è·¯ç”±</span>
</span></span><span class=line><span class=cl><span class=n>response</span> <span class=o>=</span> <span class=n>router_query_engine</span><span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=s2>&#34;è¿™ç¯‡æ–‡ç« ä¸»è¦è®²äº†ä»€ä¹ˆï¼Ÿ&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Used Tool: </span><span class=si>{</span><span class=n>response</span><span class=o>.</span><span class=n>metadata</span><span class=p>[</span><span class=s1>&#39;selector_result&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span></span></span></code></pre></div><h3 id=22-hyde-å‡è®¾æ€§æ–‡æ¡£åµŒå…¥>2.2 HyDE (å‡è®¾æ€§æ–‡æ¡£åµŒå…¥)<a class=anchor href=#22-hyde-%e5%81%87%e8%ae%be%e6%80%a7%e6%96%87%e6%a1%a3%e5%b5%8c%e5%85%a5>#</a></h3><p>åœ¨æ£€ç´¢å‰ï¼Œè®© LLM å…ˆ"å¹»è§‰"ä¸€ä¸ªç­”æ¡ˆï¼Œç”¨è¿™ä¸ªå‡è®¾æ€§ç­”æ¡ˆå»æ£€ç´¢æ–‡æ¡£ã€‚</p><ul><li><strong>åŸç†</strong>ï¼šæŸ¥è¯¢ &ldquo;å¦‚ä½•ä¼˜åŒ–ç´¢å¼•ï¼Ÿ&rdquo; -> LLM ç”Ÿæˆä¸€æ®µå…³äºç´¢å¼•ä¼˜åŒ–çš„æ–‡æœ¬ -> è®¡ç®—è¿™æ®µæ–‡æœ¬çš„å‘é‡ -> æ£€ç´¢æœ€ç›¸ä¼¼çš„çœŸå®æ–‡æ¡£ã€‚</li><li><strong>ä¼˜åŠ¿</strong>ï¼šè§£å†³äº† Query å’Œ Document è¯­ä¹‰ç©ºé—´ä¸ä¸€è‡´çš„é—®é¢˜ã€‚</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>llama_index.core.indices.query.query_transform</span> <span class=kn>import</span> <span class=n>HyDEQueryTransform</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>llama_index.core.query_engine</span> <span class=kn>import</span> <span class=n>TransformQueryEngine</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 1. å®šä¹‰ HyDE å˜æ¢</span>
</span></span><span class=line><span class=cl><span class=n>hyde</span> <span class=o>=</span> <span class=n>HyDEQueryTransform</span><span class=p>(</span><span class=n>include_original</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2. åŒ…è£…åŸå§‹æŸ¥è¯¢å¼•æ“</span>
</span></span><span class=line><span class=cl><span class=n>vector_query_engine</span> <span class=o>=</span> <span class=n>vector_index</span><span class=o>.</span><span class=n>as_query_engine</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>hyde_query_engine</span> <span class=o>=</span> <span class=n>TransformQueryEngine</span><span class=p>(</span><span class=n>vector_query_engine</span><span class=p>,</span> <span class=n>query_transform</span><span class=o>=</span><span class=n>hyde</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 3. æŸ¥è¯¢</span>
</span></span><span class=line><span class=cl><span class=n>response</span> <span class=o>=</span> <span class=n>hyde_query_engine</span><span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=s2>&#34;å¦‚ä½•æé«˜æ£€ç´¢çš„å‡†ç¡®ç‡ï¼Ÿ&#34;</span><span class=p>)</span></span></span></code></pre></div><hr><h2 id=ç¬¬3ç« é‡æ’åºæŠ€æœ¯-reranking>ç¬¬3ç« ï¼šé‡æ’åºæŠ€æœ¯ (Reranking)<a class=anchor href=#%e7%ac%ac3%e7%ab%a0%e9%87%8d%e6%8e%92%e5%ba%8f%e6%8a%80%e6%9c%af-reranking>#</a></h2><p>**&ldquo;æ£€ç´¢-ç²¾æ’&rdquo;**æ˜¯ç°ä»£ RAG çš„æ ‡å‡†èŒƒå¼ã€‚</p><ul><li><strong>Retriever</strong>: å¿«é€Ÿå¬å› Top-50ï¼ˆæ­¤æ—¶ç²¾åº¦å¯èƒ½ä¸é«˜ï¼‰ã€‚</li><li><strong>Reranker</strong>: ä½¿ç”¨é«˜ç²¾åº¦æ¨¡å‹ï¼ˆå¦‚ Cross-Encoderï¼‰å¯¹ Top-50 è¿›è¡Œé‡æ–°æ‰“åˆ†ï¼Œé€‰å‡º Top-5ã€‚</li></ul><h3 id=31-cohere-rerank-å®æˆ˜>3.1 Cohere Rerank å®æˆ˜<a class=anchor href=#31-cohere-rerank-%e5%ae%9e%e6%88%98>#</a></h3><p>Cohere æä¾›äº†ç›®å‰ä¸šç•Œå…¬è®¤æ•ˆæœæœ€å¥½çš„å•†ä¸š Rerank æ¨¡å‹ã€‚</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>llama_index.postprocessor.cohere_rerank</span> <span class=kn>import</span> <span class=n>CohereRerank</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 1.é…ç½® API Key</span>
</span></span><span class=line><span class=cl><span class=c1># os.environ[&#34;COHERE_API_KEY&#34;] = &#34;your_key&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2. å®šä¹‰ Reranker</span>
</span></span><span class=line><span class=cl><span class=n>cohere_rerank</span> <span class=o>=</span> <span class=n>CohereRerank</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>model</span><span class=o>=</span><span class=s2>&#34;rerank-english-v3.0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>top_n</span><span class=o>=</span><span class=mi>3</span>  <span class=c1># æœ€ç»ˆåªä¿ç•™å‰3å</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 3. æ³¨å…¥åˆ°æŸ¥è¯¢å¼•æ“ (ä½œä¸º Postprocessor)</span>
</span></span><span class=line><span class=cl><span class=n>query_engine</span> <span class=o>=</span> <span class=n>vector_index</span><span class=o>.</span><span class=n>as_query_engine</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>similarity_top_k</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span>  <span class=c1># ç¬¬ä¸€æ­¥ï¼šå…ˆå®½æ³›å¬å›20ä¸ª</span>
</span></span><span class=line><span class=cl>    <span class=n>node_postprocessors</span><span class=o>=</span><span class=p>[</span><span class=n>cohere_rerank</span><span class=p>]</span>  <span class=c1># ç¬¬äºŒæ­¥ï¼šç²¾æ’é€‰å‡º3ä¸ª</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>response</span> <span class=o>=</span> <span class=n>query_engine</span><span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=s2>&#34;LlamaIndex å’Œ LangChain çš„åŒºåˆ«ï¼Ÿ&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æŸ¥çœ‹é‡æ’åçš„å¾—åˆ†</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>node</span> <span class=ow>in</span> <span class=n>response</span><span class=o>.</span><span class=n>source_nodes</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Rerank Score: </span><span class=si>{</span><span class=n>node</span><span class=o>.</span><span class=n>score</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2> - </span><span class=si>{</span><span class=n>node</span><span class=o>.</span><span class=n>node</span><span class=o>.</span><span class=n>get_text</span><span class=p>()[:</span><span class=mi>30</span><span class=p>]</span><span class=si>}</span><span class=s2>...&#34;</span><span class=p>)</span></span></span></code></pre></div><hr><h2 id=ç¬¬4ç« chat-engine-å¤šè½®å¯¹è¯>ç¬¬4ç« ï¼šChat Engine (å¤šè½®å¯¹è¯)<a class=anchor href=#%e7%ac%ac4%e7%ab%a0chat-engine-%e5%a4%9a%e8%bd%ae%e5%af%b9%e8%af%9d>#</a></h2><p>åŸºç¡€çš„ <code>query_engine</code> æ˜¯æ— çŠ¶æ€çš„ï¼ˆä¸€é—®ä¸€ç­”ï¼‰ã€‚è€Œ <code>ChatEngine</code> ç»´æŠ¤äº†å¯¹è¯å†å²ï¼ˆMemoryï¼‰ï¼Œè®© RAG å…·å¤‡äº†èŠå¤©çš„èƒ½åŠ›ã€‚</p><h3 id=41-condense-plus-context-mode-æœ€ä½³å®è·µ>4.1 Condense Plus Context Mode (æœ€ä½³å®è·µ)<a class=anchor href=#41-condense-plus-context-mode-%e6%9c%80%e4%bd%b3%e5%ae%9e%e8%b7%b5>#</a></h3><p>è¿™æ˜¯å¤„ç†å¤šè½® RAG å¯¹è¯æœ€ç¨³å¥çš„æ¨¡å¼ï¼š</p><ol><li><strong>Condense</strong>: å°†"å½“å‰é—®é¢˜" + &ldquo;å†å²å¯¹è¯&rdquo; é‡å†™ä¸ºä¸€ä¸ªç‹¬ç«‹çš„ã€å®Œæ•´çš„æŸ¥è¯¢è¯­å¥ã€‚</li><li><strong>Retrieve</strong>: ç”¨é‡å†™åçš„æŸ¥è¯¢å»æ£€ç´¢ã€‚</li><li><strong>Context</strong>: å°†æ£€ç´¢ç»“æœä½œä¸ºä¸Šä¸‹æ–‡ï¼Œå›ç­”ç”¨æˆ·ã€‚</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>llama_index.core.memory</span> <span class=kn>import</span> <span class=n>ChatMemoryBuffer</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 1. è®¾ç½®è®°å¿†ç¼“å†²åŒº (Token é™åˆ¶)</span>
</span></span><span class=line><span class=cl><span class=n>memory</span> <span class=o>=</span> <span class=n>ChatMemoryBuffer</span><span class=o>.</span><span class=n>from_defaults</span><span class=p>(</span><span class=n>token_limit</span><span class=o>=</span><span class=mi>3000</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2. åˆ›å»ºèŠå¤©å¼•æ“</span>
</span></span><span class=line><span class=cl><span class=n>chat_engine</span> <span class=o>=</span> <span class=n>vector_index</span><span class=o>.</span><span class=n>as_chat_engine</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>chat_mode</span><span class=o>=</span><span class=s2>&#34;condense_plus_context&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>memory</span><span class=o>=</span><span class=n>memory</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>similarity_top_k</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>verbose</span><span class=o>=</span><span class=kc>True</span>  <span class=c1># å¼€å¯åå¯ä»¥çœ‹åˆ°&#34;é‡å†™åçš„æŸ¥è¯¢&#34;æ˜¯ä»€ä¹ˆ</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 3. å¤šè½®å¯¹è¯</span>
</span></span><span class=line><span class=cl><span class=n>response</span> <span class=o>=</span> <span class=n>chat_engine</span><span class=o>.</span><span class=n>chat</span><span class=p>(</span><span class=s2>&#34;LlamaIndex æœ‰å“ªäº›ç´¢å¼•ç±»å‹ï¼Ÿ&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>response</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ä¸‹ä¸€ä¸ªé—®é¢˜éšå«äº†ä¸Šä¸‹æ–‡ (&#34;å®ƒä»¬&#34;)</span>
</span></span><span class=line><span class=cl><span class=n>response</span> <span class=o>=</span> <span class=n>chat_engine</span><span class=o>.</span><span class=n>chat</span><span class=p>(</span><span class=s2>&#34;å®ƒä»¬ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># å†…éƒ¨ä¼šé‡å†™ä¸º: &#34;LlamaIndex çš„ä¸åŒç´¢å¼•ç±»å‹ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>response</span><span class=p>)</span></span></span></code></pre></div><hr><h2 id=ç¬¬5ç« çŸ¥è¯†å›¾è°±-rag-graphrag>ç¬¬5ç« ï¼šçŸ¥è¯†å›¾è°± RAG (GraphRAG)<a class=anchor href=#%e7%ac%ac5%e7%ab%a0%e7%9f%a5%e8%af%86%e5%9b%be%e8%b0%b1-rag-graphrag>#</a></h2><p>å‘é‡æ£€ç´¢éš¾ä»¥å¤„ç†"é•¿ç¨‹å…³ç³»"æˆ–"å…¨å±€ç†è§£"ã€‚çŸ¥è¯†å›¾è°±ï¼ˆKnowledge Graphï¼‰é€šè¿‡æ˜¾å¼çš„å®ä½“å…³ç³»å»ºæ¨¡ï¼Œå¼¥è¡¥äº†è¿™ä¸€çŸ­æ¿ã€‚</p><h3 id=51-propertygraphindex-æ„å»º>5.1 PropertyGraphIndex æ„å»º<a class=anchor href=#51-propertygraphindex-%e6%9e%84%e5%bb%ba>#</a></h3><p>LlamaIndex v0.10 æ¨å‡ºçš„ <code>PropertyGraphIndex</code> æ˜¯ç›®å‰æœ€æ˜“ç”¨çš„ GraphRAG å®ç°ï¼Œæ”¯æŒ"å›¾+å‘é‡"çš„åŒé‡æ£€ç´¢ã€‚</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>llama_index.core</span> <span class=kn>import</span> <span class=n>PropertyGraphIndex</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>llama_index.core.indices.property_graph</span> <span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>ImplicitPathExtractor</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>SimpleLLMPathExtractor</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 1. å®šä¹‰æå–å™¨ (å¦‚ä½•ä»æ–‡æœ¬å˜å›¾)</span>
</span></span><span class=line><span class=cl><span class=c1># è‡ªåŠ¨æå–å®ä½“å’Œå…³ç³»ï¼Œå¦‚ (Steve Jobs)-[FOUNDED]-&gt;(Apple)</span>
</span></span><span class=line><span class=cl><span class=n>kg_extractor</span> <span class=o>=</span> <span class=n>SimpleLLMPathExtractor</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>llm</span><span class=o>=</span><span class=n>Settings</span><span class=o>.</span><span class=n>llm</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>max_paths_per_chunk</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>num_workers</span><span class=o>=</span><span class=mi>4</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2. æ„å»ºå›¾ç´¢å¼• (åŒæ—¶ç”Ÿæˆ Embedding)</span>
</span></span><span class=line><span class=cl><span class=n>graph_index</span> <span class=o>=</span> <span class=n>PropertyGraphIndex</span><span class=o>.</span><span class=n>from_documents</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>documents</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>kg_extractors</span><span class=o>=</span><span class=p>[</span><span class=n>kg_extractor</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=n>embed_kg_nodes</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>  <span class=c1># å…³é”®ï¼šå¼€å¯å‘é‡åŒ–ï¼Œæ”¯æŒæ··åˆæ£€ç´¢</span>
</span></span><span class=line><span class=cl>    <span class=n>show_progress</span><span class=o>=</span><span class=kc>True</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 3. æ··åˆæ£€ç´¢æŸ¥è¯¢ (Graph + Vector)</span>
</span></span><span class=line><span class=cl><span class=c1># æ—¢èƒ½åŒ¹é…å…³é”®è¯å®ä½“ï¼Œé€šè¿‡å›¾æ¸¸èµ°æ‰¾åˆ°å…³ç³»ï¼Œä¹Ÿèƒ½é€šè¿‡å‘é‡åŒ¹é…è¯­ä¹‰</span>
</span></span><span class=line><span class=cl><span class=n>query_engine</span> <span class=o>=</span> <span class=n>graph_index</span><span class=o>.</span><span class=n>as_query_engine</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>include_text</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>similarity_top_k</span><span class=o>=</span><span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>response</span> <span class=o>=</span> <span class=n>query_engine</span><span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=s2>&#34;Steve Jobs å’Œ Pixar æ˜¯ä»€ä¹ˆå…³ç³»ï¼Ÿ&#34;</span><span class=p>)</span></span></span></code></pre></div><hr><h2 id=ç¬¬6ç« agent-ä¸-rag-çš„ç»ˆæèåˆ>ç¬¬6ç« ï¼šAgent ä¸ RAG çš„ç»ˆæèåˆ<a class=anchor href=#%e7%ac%ac6%e7%ab%a0agent-%e4%b8%8e-rag-%e7%9a%84%e7%bb%88%e6%9e%81%e8%9e%8d%e5%90%88>#</a></h2><p>RAG ä¸åº”åªæ˜¯ä¸€ä¸ªè¢«åŠ¨çš„æŸ¥è¯¢æ¥å£ï¼Œå®ƒåº”è¯¥æˆä¸º <strong>Agent</strong> æ‰‹ä¸­çš„ä¸€æŠŠåˆ©å™¨ï¼ˆToolï¼‰ã€‚</p><h3 id=61-rag-as-a-tool>6.1 RAG as a Tool<a class=anchor href=#61-rag-as-a-tool>#</a></h3><p>é€šè¿‡ <code>FunctionCallingAgent</code>ï¼Œæˆ‘ä»¬è®© LLM è‡ªä¸»å†³å®šä½•æ—¶æŸ¥æ–‡æ¡£ã€æŸ¥å“ªä»½æ–‡æ¡£ï¼Œç”šè‡³è¿›è¡Œå¤šæ­¥æ¨ç†ã€‚</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>llama_index.core.tools</span> <span class=kn>import</span> <span class=n>QueryEngineTool</span><span class=p>,</span> <span class=n>ToolMetadata</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>llama_index.core.agent</span> <span class=kn>import</span> <span class=n>FunctionCallingAgentWorker</span><span class=p>,</span> <span class=n>AgentRunner</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 1. å°† QueryEngine åŒ…è£…ä¸º Tool</span>
</span></span><span class=line><span class=cl><span class=n>rag_tool</span> <span class=o>=</span> <span class=n>QueryEngineTool</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>query_engine</span><span class=o>=</span><span class=n>vector_index</span><span class=o>.</span><span class=n>as_query_engine</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>    <span class=n>metadata</span><span class=o>=</span><span class=n>ToolMetadata</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>name</span><span class=o>=</span><span class=s2>&#34;company_wiki&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>description</span><span class=o>=</span><span class=s2>&#34;ç”¨äºæŸ¥è¯¢å…¬å¸å†…éƒ¨è§„ç« åˆ¶åº¦ã€æŠ¥é”€æµç¨‹ã€å‡æœŸæ”¿ç­–ç­‰ã€‚&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2. åˆ›å»º Agent</span>
</span></span><span class=line><span class=cl><span class=n>agent_worker</span> <span class=o>=</span> <span class=n>FunctionCallingAgentWorker</span><span class=o>.</span><span class=n>from_tools</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>tools</span><span class=o>=</span><span class=p>[</span><span class=n>rag_tool</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=n>llm</span><span class=o>=</span><span class=n>Settings</span><span class=o>.</span><span class=n>llm</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>verbose</span><span class=o>=</span><span class=kc>True</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>agent</span> <span class=o>=</span> <span class=n>AgentRunner</span><span class=p>(</span><span class=n>agent_worker</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 3. å¤æ‚ä»»åŠ¡ (ReAct æ¨¡å¼)</span>
</span></span><span class=line><span class=cl><span class=c1># ç”¨æˆ·é—®ï¼š&#34;æˆ‘ä¸‹å‘¨æƒ³è¯·å¹´å‡ï¼Œæµç¨‹æ˜¯ä»€ä¹ˆï¼Ÿå¦‚æœæˆ‘è¿˜æœ‰5å¤©å¹´å‡ï¼Œå¤Ÿå—ï¼Ÿ&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># Agent ä¼šï¼š</span>
</span></span><span class=line><span class=cl><span class=c1># 1. è°ƒç”¨ company_wiki æŸ¥&#34;è¯·å‡æµç¨‹&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># 2. è¿™é‡Œæ¼”ç¤ºçš„æ˜¯å•æ­¥ï¼Œå¦‚æœæ¥äº†æ•°æ®åº“å·¥å…·ï¼Œå®ƒè¿˜èƒ½å»æŸ¥&#34;å‰©ä½™å¹´å‡&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># 3. ç»¼åˆå›ç­”</span>
</span></span><span class=line><span class=cl><span class=n>response</span> <span class=o>=</span> <span class=n>agent</span><span class=o>.</span><span class=n>chat</span><span class=p>(</span><span class=s2>&#34;è¯·å‡æµç¨‹æ€ä¹ˆèµ°ï¼Ÿ&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>response</span><span class=p>)</span></span></span></code></pre></div><hr><h2 id=ç¬¬7ç« æ€»ç»“ä¸å±•æœ›>ç¬¬7ç« ï¼šæ€»ç»“ä¸å±•æœ›<a class=anchor href=#%e7%ac%ac7%e7%ab%a0%e6%80%bb%e7%bb%93%e4%b8%8e%e5%b1%95%e6%9c%9b>#</a></h2><h3 id=71-llamaindex-æ ¸å¿ƒèƒ½åŠ›å¤§å›¾>7.1 LlamaIndex æ ¸å¿ƒèƒ½åŠ›å¤§å›¾<a class=anchor href=#71-llamaindex-%e6%a0%b8%e5%bf%83%e8%83%bd%e5%8a%9b%e5%a4%a7%e5%9b%be>#</a></h3><table><thead><tr><th style=text-align:left>æ¨¡å—</th><th style=text-align:left>æ ¸å¿ƒç»„ä»¶</th><th style=text-align:left>è§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ</th></tr></thead><tbody><tr><td style=text-align:left><strong>Indexing</strong></td><td style=text-align:left>VectorStoreIndex, SummaryIndex, PropertyGraphIndex</td><td style=text-align:left>å¦‚ä½•é«˜æ•ˆã€ç»“æ„åŒ–åœ°å­˜å‚¨æ•°æ®ï¼Ÿ</td></tr><tr><td style=text-align:left><strong>Retrieval</strong></td><td style=text-align:left>Hybrid Retrieval, RouterRetriever</td><td style=text-align:left>å¦‚ä½•ä»æµ·é‡æ•°æ®ä¸­ç²¾å‡†æå‡ºç›¸å…³ç‰‡æ®µï¼Ÿ</td></tr><tr><td style=text-align:left><strong>Reranking</strong></td><td style=text-align:left>CohereRerank</td><td style=text-align:left>å¦‚ä½•åœ¨å¬å›ç»“æœä¸­å»ç²—å–ç²¾ï¼Œæå‡ Top-1 å‡†ç¡®ç‡ï¼Ÿ</td></tr><tr><td style=text-align:left><strong>Querying</strong></td><td style=text-align:left>SubQuestion, MultiStep, HyDE</td><td style=text-align:left>å¦‚ä½•å¤„ç†å¤æ‚ã€æ¨¡ç³Šã€å¤šè·³çš„ç”¨æˆ·é—®é¢˜ï¼Ÿ</td></tr><tr><td style=text-align:left><strong>Integration</strong></td><td style=text-align:left>ChatEngine, AgentRunner</td><td style=text-align:left>å¦‚ä½•å°†é™æ€æŸ¥è¯¢å˜ä¸ºåŠ¨æ€äº¤äº’ä¸æ™ºèƒ½ä½“ï¼Ÿ</td></tr></tbody></table><h3 id=72-è¿›é˜¶å­¦ä¹ è·¯çº¿>7.2 è¿›é˜¶å­¦ä¹ è·¯çº¿<a class=anchor href=#72-%e8%bf%9b%e9%98%b6%e5%ad%a6%e4%b9%a0%e8%b7%af%e7%ba%bf>#</a></h3><ol><li><strong>Fine-tuning Embeddings</strong>: å¦‚æœä½ çš„é¢†åŸŸéå¸¸å‚ç›´ï¼ˆå¦‚æ³•å¾‹ã€åŒ»ç–—ï¼‰ï¼Œé€šç”¨ Embedding æ¨¡å‹æ•ˆæœä¸ä½³ï¼Œè¯•ç€ä½¿ç”¨ LlamaIndex çš„ <code>SentenceTransformerFineTuning</code> æ¨¡å—å¾®è°ƒè‡ªå·±çš„ Embeddingã€‚</li><li><strong>RAG Evaluation</strong>: ä¸è¦å‡­æ„Ÿè§‰ä¼˜åŒ–ã€‚å¼•å…¥ <code>Ragas</code> æˆ– <code>DeepEval</code>ï¼Œå»ºç«‹ç”± <code>Faithfulness</code>ï¼ˆå¿ å®åº¦ï¼‰å’Œ <code>Answer Relevance</code>ï¼ˆç›¸å…³åº¦ï¼‰æ„æˆçš„è‡ªåŠ¨åŒ–æµ‹è¯•é›†ã€‚</li><li><strong>Local RAG</strong>: å°è¯•ä½¿ç”¨ <code>Ollama</code> + <code>LlamaIndex</code>ï¼Œæ„å»ºå®Œå…¨è¿è¡Œåœ¨æœ¬åœ°éšç§ç¯å¢ƒä¸‹çš„ RAG ç³»ç»Ÿã€‚</li></ol><p>LlamaIndex çš„å¼ºå¤§ä¹‹å¤„åœ¨äºå…¶<strong>æé«˜çš„æ¨¡å—åŒ–</strong>å’Œ<strong>æ•°æ®ä¼˜å…ˆ</strong>çš„è®¾è®¡å“²å­¦ã€‚æŒæ¡äº†æœ¬ç¯‡çš„é«˜çº§æŠ€å·§ï¼Œä½ å·²ç»å…·å¤‡äº†æ„å»ºä¼ä¸šçº§ RAG åº”ç”¨çš„æ ¸å¿ƒèƒ½åŠ›ã€‚</p><hr></article><div style="margin-top:2rem;border-top:1px solid #e5e7eb;padding-top:1rem;font-size:.85rem;color:#6b7280;text-align:center">[ç»Ÿè®¡ç»„ä»¶ä»…åœ¨ç”Ÿäº§ç¯å¢ƒæ˜¾ç¤º]</div><div class=giscus style=margin-top:2rem></div><script src=https://giscus.app/client.js data-repo=LordFoxFairy/LordFoxFairy.github.io data-repo-id=R_kgDOQ-JRGA data-category=Announcements data-category-id=DIC_kwDOQ-JRGM4C1PDC data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=preferred_color_scheme data-lang=zh-CN data-loading=lazy crossorigin=anonymous async></script><footer class=book-footer><div class="flex flex-wrap justify-between"><div></div><div></div></div><div class="flex flex-wrap justify-between"><span><a href=/notebooks/langchain%E7%AC%94%E8%AE%B0/%E7%AC%AC%E4%BA%94%E7%AF%87-rag%E9%AB%98%E7%BA%A7%E7%AF%87langchain%E7%AF%87/ class="flex align-center"><img src=/icons/backward.svg class=book-icon alt=Backward>
<span>ç¬¬äº”ç¯‡ RAGé«˜çº§ç¯‡(LangChainç¯‡)</span>
</a></span><span><a href=/notebooks/langchain%E7%AC%94%E8%AE%B0/%E7%AC%AC%E5%85%AD%E7%AF%87-%E6%96%87%E6%A1%A3%E5%A4%84%E7%90%86%E4%B8%8E%E6%95%B0%E6%8D%AE%E6%B8%85%E6%B4%97/ class="flex align-center"><span>ç¬¬å…­ç¯‡ æ–‡æ¡£å¤„ç†ä¸æ•°æ®æ¸…æ´—</span>
<img src=/icons/forward.svg class=book-icon alt=Forward></a></span></div><div class=book-comments></div><script>(function(){document.querySelectorAll("pre:has(code)").forEach(e=>{e.addEventListener("click",e.focus),e.addEventListener("copy",function(t){if(t.preventDefault(),navigator.clipboard){const t=window.getSelection().toString()||e.textContent;navigator.clipboard.writeText(t)}})})})()</script></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#-å‰ç½®å‡†å¤‡>ğŸ“‹ å‰ç½®å‡†å¤‡</a></li><li><a href=#ç¬¬1ç« æ··åˆæ£€ç´¢-hybrid-retrieval>ç¬¬1ç« ï¼šæ··åˆæ£€ç´¢ (Hybrid Retrieval)</a><ul><li><a href=#11-ä¸ºä»€ä¹ˆéœ€è¦æ··åˆæ£€ç´¢>1.1 ä¸ºä»€ä¹ˆéœ€è¦æ··åˆæ£€ç´¢ï¼Ÿ</a></li><li><a href=#12-å®æˆ˜æ„å»ºæ··åˆæ£€ç´¢å™¨>1.2 å®æˆ˜ï¼šæ„å»ºæ··åˆæ£€ç´¢å™¨</a></li></ul></li><li><a href=#ç¬¬2ç« æŸ¥è¯¢ä¼˜åŒ–ä¸è·¯ç”±-routing--transformation>ç¬¬2ç« ï¼šæŸ¥è¯¢ä¼˜åŒ–ä¸è·¯ç”± (Routing & Transformation)</a><ul><li><a href=#21-router-query-engine-è‡ªåŠ¨è·¯ç”±>2.1 Router Query Engine (è‡ªåŠ¨è·¯ç”±)</a></li><li><a href=#22-hyde-å‡è®¾æ€§æ–‡æ¡£åµŒå…¥>2.2 HyDE (å‡è®¾æ€§æ–‡æ¡£åµŒå…¥)</a></li></ul></li><li><a href=#ç¬¬3ç« é‡æ’åºæŠ€æœ¯-reranking>ç¬¬3ç« ï¼šé‡æ’åºæŠ€æœ¯ (Reranking)</a><ul><li><a href=#31-cohere-rerank-å®æˆ˜>3.1 Cohere Rerank å®æˆ˜</a></li></ul></li><li><a href=#ç¬¬4ç« chat-engine-å¤šè½®å¯¹è¯>ç¬¬4ç« ï¼šChat Engine (å¤šè½®å¯¹è¯)</a><ul><li><a href=#41-condense-plus-context-mode-æœ€ä½³å®è·µ>4.1 Condense Plus Context Mode (æœ€ä½³å®è·µ)</a></li></ul></li><li><a href=#ç¬¬5ç« çŸ¥è¯†å›¾è°±-rag-graphrag>ç¬¬5ç« ï¼šçŸ¥è¯†å›¾è°± RAG (GraphRAG)</a><ul><li><a href=#51-propertygraphindex-æ„å»º>5.1 PropertyGraphIndex æ„å»º</a></li></ul></li><li><a href=#ç¬¬6ç« agent-ä¸-rag-çš„ç»ˆæèåˆ>ç¬¬6ç« ï¼šAgent ä¸ RAG çš„ç»ˆæèåˆ</a><ul><li><a href=#61-rag-as-a-tool>6.1 RAG as a Tool</a></li></ul></li><li><a href=#ç¬¬7ç« æ€»ç»“ä¸å±•æœ›>ç¬¬7ç« ï¼šæ€»ç»“ä¸å±•æœ›</a><ul><li><a href=#71-llamaindex-æ ¸å¿ƒèƒ½åŠ›å¤§å›¾>7.1 LlamaIndex æ ¸å¿ƒèƒ½åŠ›å¤§å›¾</a></li><li><a href=#72-è¿›é˜¶å­¦ä¹ è·¯çº¿>7.2 è¿›é˜¶å­¦ä¹ è·¯çº¿</a></li></ul></li></ul></nav></div></aside></main></body></html>